machine:
  node:
    version: 6.9.1
  ruby:
    version: '2.3'
  environment:
      PATH: "${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/node_modules/.bin"
dependencies:
  override:
    - yarn
    - yarn add g ionic
  cache_directories:
    - ~/.cache/yarn
compile:
  override:
    - yarn run build
deployment:
  master:
    branch: master
    owner: platanus
    commands:
      - ionic login
      - ionic upload
  release:
    tag: /v[0-9]+(\.[0-9]+)*/
    owner: platanus
    commands:
      - ionic login
      - PROFILE_NAME=$(./cibuild)
      - ionic package build android --profile ${PROFILE_NAME}_production --release
test:
  override:
    - echo "no tests :("
